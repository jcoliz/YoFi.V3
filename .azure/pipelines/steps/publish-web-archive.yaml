#
# Publish web app, archive, and publish as build artifact
#

steps:
- task: DotNetCoreCLI@2
  displayName: 'Publish web app'
  inputs:
    command: 'publish'
    workingDirectory: $(Project.MainDirectory)
    publishWebProjects: false
    arguments: '--output $(Project.PublishDirectory) --configuration Release -a x64'
    zipAfterPublish: false
    modifyOutputPath: false

- task: ArchiveFiles@2
  displayName: 'Archive files'
  inputs:
    rootFolderOrFile: $(Project.PublishDirectory)
    includeRootFolder: false
    archiveType: zip
    archiveFile: $(Project.ArtifactFile)
    replaceExistingArchive: true

- publish: $(Project.ArtifactFile)
  displayName: 'Publish $(Artifact.MainProject) Artifact'
  artifact: $(Artifact.MainProject)
  