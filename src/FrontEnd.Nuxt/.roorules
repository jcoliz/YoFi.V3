# Project-specific rules for Roo AI assistant

## Files to Never Edit

### Auto-generated API Client

- **NEVER** edit `app/utils/apiclient.ts` - this file is auto-generated using the NSwag toolchain from the backend API specification
- Any changes to this file will be overwritten when the API client is regenerated
- To modify API client behavior, update the backend API or NSwag configuration instead

## Error Handling Patterns

### API Exception Handling

When working with API clients, always use the `handleApiError` helper from the error handler utility:

```typescript
import { handleApiError } from '~/utils/errorHandler'
import type { IProblemDetails } from '~/utils/apiclient'

// State
const error = ref<IProblemDetails | undefined>(undefined)
const showError = ref(false)

// API call with proper error handling
try {
  await apiClient.someMethod()
} catch (err) {
  error.value = handleApiError(err)
  showError.value = true
}
```

**With custom fallback messages:**

```typescript
try {
  await apiClient.deleteItem(id)
} catch (err) {
  error.value = handleApiError(err, 'Delete Failed', 'Could not delete the item')
  showError.value = true
}
```

**Rules:**

- **ALWAYS** use `handleApiError()` helper for API client error handling - it's DRY and consistent
- **NEVER** use `catch (err: any)` - use `catch (err)` instead
- **NEVER** manually check `ApiException.isApiException(err)` - the helper handles this
- **DO** provide custom fallback title/detail for better UX when appropriate
- **DO** clear errors before API calls: `error.value = undefined` and `showError.value = false`

### ErrorDisplay Component

Use the `ErrorDisplay` component for all error messages:

```vue
<ErrorDisplay v-model:show="showError" :problem="error" class="mb-4" />
```

**Benefits:**

- Consistent error display across the application
- Supports RFC 7807 Problem Details format
- Shows trace IDs for server errors (500+)
- Dismissible by users
- Handles expandable details automatically

### Client-Side Validation Errors

For validation errors that don't involve API calls:

```typescript
if (!formData.value.trim()) {
  error.value = {
    title: 'Validation Error',
    detail: 'Field name is required',
  }
  showError.value = true
  return
}
```

### Error State Management

**Always:**

- Clear errors before making API calls: `error.value = undefined` and `showError.value = false`
- Store errors as `IProblemDetails | undefined`, not strings
- Use a separate `showError` boolean to control `ErrorDisplay` visibility
